$(document).ready(function() {
    // $('#ref_search').
    $("#ref_search").click(function(e) {
        // e.preventDefault();
        // console.log($("#ref_no").val());

        $.ajax({
            type: "POST",
            url: base_url + "/get-support-ticket",
            data: {
                "_token": $("#csrfToken").val(),
                "ref_no": $("#ref_no").val(),
            },
            success: function(result) {
                // console.log(data);
                console.log(result);
                $("#ticketDetails").show();

                document.getElementById("ticketDetails").innerHTML = 
                        '<div class="card-header">' +
                            '<h4 class="card-title" id="card-title">Comments on Reference No: ' + $("#ref_no").val() + '</h4>'+
                            '<div class="container">' +
                                '<h5>Ticket Generated By: ' + result["ticket"]["customer_name"] + '</h5>' +
                                '<h6>Problem Description: ' + result["ticket"]["problem_description"] + '</h6>'+
                            '</div>' +
                        '</div>' +
                        '<div class="card-body" id="ticketDetailsbody"></div>';

                commments = result["comments"]
                commments.forEach(element => {
                    // console.log(element)
                    document.getElementById("ticketDetailsbody").innerHTML +=
                        '<div class="container">' +
                            '<h5>Agent Name: ' + element["agent"]["agent_name"] + '</h5>' +
                            '<h6>(Contact no: ' + element["agent"]["contact_number"] + ', Email: ' + element["agent"]["email"] + ')</h6>'+
                            '<h6>Commented Date Time: ' + element["comment_details"]["commented_date_time"] + '</h6>'+
                            '<h6>Comment: ' + element["comment_details"]["comment"] + '</h6>'+
                        '</div> <br>';
                    
                });

                
            },
            error: function(result) {
                console.log(result);
            }
        });
    });
});